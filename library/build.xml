<project name="passwdhash-lib" default="rebuild">
	<property name="dir.src" location="src"/>
	<property name="dir.bin" location="bin"/>
	<property name="dir.out" location="dist"/>

	<loadresource property="jdk.version">
		<propertyresource name="ant.java.version"/>
		<filterchain>
			<replaceregex pattern="^1\.(\d)$" replace="\1"/>
		</filterchain>
	</loadresource>

	<target name="rebuild" depends="clean,jar">
		<echo message="Rebuild completed."/>
	</target>

	<target name="clean">
		<delete includeemptydirs="true" verbose="true">
			<fileset dir="${dir.bin}" includes="**/*" excludes="**/.gitkeep" defaultexcludes="false"/>
			<fileset dir="${dir.out}" includes="**/*" excludes="**/.gitkeep" defaultexcludes="false"/>
		</delete>
	</target>

	<target name="compile">
		<delete includeemptydirs="true" verbose="true">
			<fileset dir="${dir.bin}" includes="**/*" excludes="**/.gitkeep" defaultexcludes="false"/>
		</delete>
		<javac srcdir="${dir.src}" destdir="${dir.bin}" includeantruntime="false"/>
	</target>

	<target name="jar" depends="compile">
		<delete includeemptydirs="true" verbose="true">
			<fileset dir="${dir.out}" includes="**/*" excludes="**/.gitkeep" defaultexcludes="false"/>
		</delete>
		<jar destfile="${dir.out}/${ant.project.name}.jdk-${jdk.version}.jar" basedir="${dir.bin}"/>
	</target>
</project>
